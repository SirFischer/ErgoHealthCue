<?xml version="1.0" encoding="UTF-8"?>
<!-- 
  NOTE: This is a TEMPLATE file. 
  It will be OVERWRITTEN by GenerateWixFile.ps1 during the build process.
  The build script dynamically generates the complete file list from the publish directory.
  Do not edit this file manually - edit GenerateWixFile.ps1 instead.
-->
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Package 
    Name="ErgoHealthCue" 
    Manufacturer="ErgoHealthCue"
    Version="1.0.0" 
    UpgradeCode="A1B2C3D4-E5F6-4A5B-8C9D-0E1F2A3B4C5D"
    Language="1033"
    Codepage="1252">
    
    <SummaryInformation 
      Keywords="Installer"
      Description="ErgoHealthCue Installer"
      Manufacturer="ErgoHealthCue" />

    <!-- Major Upgrade Configuration -->
    <MajorUpgrade 
      DowngradeErrorMessage="A newer version of ErgoHealthCue is already installed."
      AllowDowngrades="no"
      AllowSameVersionUpgrades="no" />

    <!-- Media Definition -->
    <Media Id="1" Cabinet="ErgoHealthCue.cab" EmbedCab="yes" />

    <!-- Installation Directory Structure -->
    <StandardDirectory Id="ProgramFiles6432Folder">
      <Directory Id="INSTALLFOLDER" Name="ErgoHealthCue">
        <Component Id="MainExecutable" Bitness="always64">
          <File 
            Id="ErgoHealthCueExe" 
            Name="ErgoHealthCue.exe" 
            Source="..\ErgoHealthCue\bin\Release\net8.0-windows\win-x64\publish\ErgoHealthCue.exe"
            KeyPath="yes">
            <Shortcut 
              Id="StartMenuShortcut"
              Directory="ProgramMenuFolder"
              Name="ErgoHealthCue"
              Description="Ergonomic health reminder application"
              WorkingDirectory="INSTALLFOLDER"
              Icon="ErgoHealthCueIcon"
              IconIndex="0"
              Advertise="yes" />
            <Shortcut 
              Id="DesktopShortcut"
              Directory="DesktopFolder"
              Name="ErgoHealthCue"
              Description="Ergonomic health reminder application"
              WorkingDirectory="INSTALLFOLDER"
              Icon="ErgoHealthCueIcon"
              IconIndex="0"
              Advertise="yes" />
          </File>
        </Component>
        
        <!-- Application files - using wildcards to include all published files -->
        <Component Id="AppFiles" Bitness="always64">
          <File Id="AppDll" Source="..\ErgoHealthCue\bin\Release\net8.0-windows\win-x64\publish\*.dll" />
          <File Id="RuntimeConfigJson" Source="..\ErgoHealthCue\bin\Release\net8.0-windows\win-x64\publish\*.json" />
          <File Id="RuntimeConfigDeps" Source="..\ErgoHealthCue\bin\Release\net8.0-windows\win-x64\publish\*.deps.json" />
        </Component>
      </Directory>
    </StandardDirectory>

    <!-- Desktop Folder -->
    <StandardDirectory Id="DesktopFolder" />
    
    <!-- Start Menu Folder -->
    <StandardDirectory Id="ProgramMenuFolder" />

    <!-- Icon for shortcuts and Add/Remove Programs -->
    <Icon Id="ErgoHealthCueIcon" SourceFile="..\ErgoHealthCue\bin\Release\net8.0-windows\win-x64\publish\ErgoHealthCue.exe" />
    
    <!-- Add/Remove Programs Icon -->
    <Property Id="ARPPRODUCTICON" Value="ErgoHealthCueIcon" />
    
    <!-- Add/Remove Programs Information -->
    <Property Id="ARPHELPLINK" Value="https://github.com/SirFischer/ErgoHealthCue" />
    <Property Id="ARPURLINFOABOUT" Value="https://github.com/SirFischer/ErgoHealthCue" />
    <Property Id="ARPNOREPAIR" Value="yes" Secure="yes" />
    
    <!-- Features to Install -->
    <Feature Id="Complete" Level="1">
      <ComponentRef Id="MainExecutable" />
      <ComponentRef Id="AppFiles" />
    </Feature>
  </Package>
</Wix>
